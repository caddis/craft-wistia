!function(){function e(){var e=$(".js-element-select");d.elements=new Craft.BaseElementSelectInput({id:e.attr("id"),limit:e.data("max"),onRemoveElements:function(){t()}})}function t(){var e=$(".js-add");$(d.elements.getSelectedElementIds()).length>=$(".js-element-select").data("max")?e.addClass(d.isDisabled):e.removeClass(d.isDisabled)}function s(){$(".js-add").on("click",function(){$(this).hasClass(d.isDisabled)||(d.modal?d.modal.show():$.get(Craft.getActionUrl("wistia/videos/getModal",{projectIds:$(".js-element-select").data("projects")}),function(e){d.modal=new Garnish.Modal($(e),{onShow:function(){l()}}),d.modal.addListener(".js-close-modal","click","hide"),d.selector=new Garnish.Select($(".js-element-body"),$(".js-element-row:not(.disabled)"),{onSelectionChange:function(){n()}}),i(),n(),a()}))})}function a(){$(".js-submit").on("click",function(){var e=$(this),s=d.selector,a=s.getSelectedItems();e.hasClass(d.isDisabled)||(a.each(function(e,s){var a=$(s),l=a.find($(".element")).clone().addClass("removable").prepend('<input name="fields['+$(".js-element-select").data("name")+'][]" type="hidden" value="'+a.data("id")+'"><a class="delete icon" title="'+Craft.t("Remove")+'"></a>');d.elements.appendElement(l),d.elements.addElements(l),t()}),d.modal.hide(),e.addClass(d.isDisabled),s.deselectAll(a))})}function l(){$(".js-element-row").each(function(e,t){var s=$(t);s.removeClass(d.isDisabled),$(d.elements.getSelectedElementIds()).each(function(e,t){s.data("id")===t&&s.addClass(d.isDisabled)})})}function n(){$submit=$(".js-submit"),d.selector.getTotalSelected()>0?$submit.removeClass(d.isDisabled):$submit.addClass(d.isDisabled)}function i(){$(".js-element-search").on("keyup",function(){var e=$(this);d.filterSearchTimer&&clearTimeout(d.filterSearchTimer),d.filterSearchTimer=setTimeout(function(){var t=e.val();$(".js-element-row").each(function(){var e=$(this);e.data("title").search(new RegExp(t,"i"))<0?e.hide():e.show()})},300)})}var d={elements:{},selector:{},isDisabled:"disabled",isSelected:"sel"};e(),s()}();